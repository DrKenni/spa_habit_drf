# Трекер полезных привычек - бэкенд-часть SPA веб-приложения
## Описание
Проэкт реализован по мативам книги Atomic Habits. В книге описывается пример привычки, как действие, к которому хочешь 
привыкнуть, укладывают в одно предложение `я буду [ДЕЙСТВИЕ] в [ВРЕМЯ] в [МЕСТО]`. За кождое выполнение пологается 
вознаграждение или поощерение приятной привычкой.
### Реализованы задачи:
* Настроен CORS.
* Настроена интеграция с Telegram.
* Реализована пагинация (с выводом по 5 привычек на страницу).
* Реализованы валидаторы:
  * Проверка на наличие или корректность ввода Telegram username.
  * Невозможен одновременный выбор связанной привычки и указания вознаграждения.
  * Время выполнения должно быть не больше 120 секунд.
  * В связанные привычки могут попадать только привычки с признаком приятной привычки.
  * У приятной привычки не может быть:
    * Вознаграждения или связанной привычки.
    * Переодичности.
  * Нельзя выполнять привычку реже, чем 1 раз в 7 дней.
* Модели описаны или переопределены.
* Эндпоинты реализовали.
  * Регистрация
  * Авторизация
  * Список привычек текущего пользователя
  * Список публичных привычек
  * Создание привычки
  * Редактирование привычки
  * Удаление привычки
* Описаны права доступа:
    * Каждый пользователь имеет доступ только к своим привычкам по механизму CRUD.
    * Пользователь может видеть список публичных привычек
* Настроена отложенная задача через Celery.
* Имеется список зависимостей.
* Результат проверки Flake8 равен 100%, при исключении миграций.
## Технологии
* Python
* Django, DRF
* JWT, DRF-YASG
* PostgreSQL
* Celery, Redis
* Requests
## Сущности
* Привычки
* Пользователь
## Документация проекта
http://127.0.0.1:8000/docs/
## Прежде чем начать использовать проект нужно:
* Установить PostgreSQL и предварительно настроить БД.
* Установить Redis.
* Создать в проекте файл `.evn` и указать нужные данные из файла `.evn.sample`.
## `.evn`
```
# Database
POSTGRES_PASSWORD=
POSTGRES_USER=
POSTGRES_DB=

#Telegram
TELEGRAM_TOKEN=

# Django settings
SECRET_KEY=
DEBUG=
```
## Инструкция по запуску приложения:
Для запуска проекта необходимо клонировать репозиторий и создать и активировать виртуальное окружение: 
```
poetry shell
```
Установить зависимости:
```
poetry init
```
Выполнить миграции:
```
python manage.py migrate
```

Для создания администратора запустить команду:

```
python manage.py csu
```

Для запуска redis:

```
redis-cli
```

Для запуска celery:

```
celery -A config worker -l info
```
На Windows:
```
celery -A config worker -l info -P eventlet 
```

Для запуска django-celery-beat:

```
celery -A config beat -l info
```

Для запуска приложения:

```
python manage.py runserver
```

_Для тестирования проекта запустить команду:_

```
python manage.py test
```
### Запуск проекта в Docker:
Необходимо создать файл .env и заполнить его согласно файлу .env.sample:
```
# Database
POSTGRES_PASSWORD=
POSTGRES_USER=
POSTGRES_DB=

#Telegram
TELEGRAM_TOKEN=

# Django settings
SECRET_KEY=
DEBUG=
```
Для создания образа из Dockerfile и запуска контейнера запустить команду:
```
docker-compose up --build
```
